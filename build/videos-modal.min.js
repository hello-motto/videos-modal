/**
 * Videos Modal Plugin https://github.com/hello-motto
 * 
 * Version 1.0.10
 * 
 * @author Jean-Baptiste MOTTO <contact@hello-motto.fr>
 */
class VideosModal{constructor(t={}){let e=this;return e.clickHandler=e.onClick.bind(e),e.init(t,!1),this}init(t,e){let i=this;!0!==e&&i.setDefaultOptions();for(let e in t)void 0!==i.options[e]&&(i.options[e]=t[e]);return!0!==e&&i.setVideosModalContainer(),i.setLinks(),i.initEvents(e),this}initEvents(t){let e,i=this;for(!0!==t&&(window.addEventListener?window.addEventListener("keydown",(function(t){i.onKeyDown(t)}),!1):window.attachEvent("onkeydown",(function(t){i.onKeyDown(t)})),!0===i.options.closeByIcon&&document.getElementById("videos-modal-close").addEventListener("click",(function(){i.close()})),!0===this.options.closeOnClick&&document.getElementById("videos-modal-background").addEventListener("click",(function(){i.close()}))),e=0;e<i.linksNumber;e++)!0===i.options.navigate&&i.linksNumber>1&&i.links[e].setAttribute("data-videos-modal-order",e),i.links[e].addEventListener("click",i.clickHandler,!1);return this}onClick(t){t.preventDefault();let e=t.currentTarget;this.open(e)}getSupportedProviders(){return["youtube","dailymotion","vimeo","youtubeplaylist"]}isProviderSupported(t){return this.getSupportedProviders().indexOf(t)>-1}setLinks(){let t=this;return t.currentLink=0,t.links=document.querySelectorAll(t.options.links),t.linksNumber=t.links.length,this}reset(){let t=this,e=t.links;for(let i=0;i<t.linksNumber;i++)e[i].removeEventListener("click",t.clickHandler);return t.init(t.options,!0)}setDefaultOptions(){this.options=[],this.options.closeOnClick=!0,this.options.closeWithEscape=!0,this.options.closeByIcon=!0,this.options.closeIcon=!0===this.options.closeByIcon?this.getDefaultCloseIcon():null,this.options.loading=!0,this.options.loaderIcon=!0===this.options.loading?this.getDefaultLoaderIcon():null,this.options.navigate=!0,this.options.leftArrow=!0===this.options.navigate?this.getDefaultLeftArrow():null,this.options.rightArrow=!0===this.options.navigate?this.getDefaultRightArrow():null,this.options.tarteAuCitron=null,this.options.links=".videos-modal-link",this.options.onlyLandscape=!0,this.options.videos_provider="media",this.options.videos_id=null,this.options.videos_width=null,this.options.videos_height=null,this.options.videos_autoplay=0,this.options.videos_rel=0,this.options.videos_controls=0,this.options.videos_showinfo=0,this.options.videos_allowfullscreen=0,this.options.videos_theme="dark",this.options.videos_title=!0,this.options.videos_byline=!0,this.options.videos_portrait=!0,this.options.videos_loop=0,this.options.videos_muted=1,this.options.videos_poster="",this.options.videos_preload="auto",this.options.videos_mp4=null,this.options.videos_ogg=null,this.options.videos_webm=null}open(t){let e=this,i=e.getVideosModalContainer(),o=e.getLinkProvider(t);if(e.isTarteAuCitronEnabled()&&!e.isProviderAllowedByTarteAuCitron(o))e.options.tarteAuCitron.userInterface.openPanel();else if(i.classList.add("opened"),i.appendChild(e.getVideoTemplate(t)),e.hasNoProvider(t)||e.isProviderAllowedByTarteAuCitron(o)&&e.options.tarteAuCitron.services[o].js(),!0===e.options.navigate&&e.linksNumber>1){e.currentLink=parseInt(t.getAttribute("data-videos-modal-order"));let o=e.createLink(e.getPrevLink());o.setAttribute("id","videos-modal-prev-link"),o.addEventListener("click",(function(t){t.preventDefault(),e.prev()})),o.insertAdjacentHTML("afterbegin",e.options.leftArrow);let s=e.createLink(e.getNextLink());s.setAttribute("id","videos-modal-next-link"),s.addEventListener("click",(function(t){t.preventDefault(),e.next()})),s.insertAdjacentHTML("afterbegin",e.options.rightArrow),i.appendChild(o),i.appendChild(s)}return this}close(){return document.getElementById("videos-modal").classList.remove("opened"),this.removeVideoContainer(),this.removeNavigationLinks(),this}prev(){let t=this.getNavigationPrevLink();return this.updateNavigationLinks(t),this}next(){let t=this.getNavigationNextLink();return this.updateNavigationLinks(t),this}updateNavigationLinks(t){let e=this,i=t.getAttribute("data-videos-modal-provider"),o=e.getVideosModalContainer(),s=document.getElementById("videos-modal-prev-link"),n=document.getElementById("videos-modal-next-link");if(e.isProviderSupported(i),!e.isTarteAuCitronEnabled()||e.hasNoProvider(t)||e.isProviderAllowedByTarteAuCitron(i)){let r=e.getVideoTemplate(t);e.currentLink=parseInt(t.getAttribute("data-videos-modal-order")),e.removeVideoContainer(),e.editLink(s,e.getPrevLink()),e.editLink(n,e.getNextLink()),o.appendChild(r),e.isProviderAllowedByTarteAuCitron(i)&&e.options.tarteAuCitron.services[i].js()}else e.close(),e.options.tarteAuCitron.userInterface.openPanel();return this}getLinks(){return document.querySelectorAll(this.options.links)}getLink(t){return this.getLinks()[t]}getCurrentLink(){return this.getLinks()[this.currentLink]}getPrevLink(){let t=this.currentLink>0?this.currentLink-1:this.linksNumber-1;return this.getLink(t)}getNextLink(){let t=this.currentLink===this.linksNumber-1?0:this.currentLink+1;return this.getLink(t)}getLinkProvider(t){let e=this,i=t.getAttribute("data-videos-modal-provider");return null!=i&&""!==i||(i=e.options.videos_provider),i}removeNavigationLinks(){let t,e=this.getVideosModalContainer().getElementsByTagName("a");for(t=e.length-1;t>=0;t--)e[t].parentNode.removeChild(e[t]);return this}getCloseIcon(){return this.options.closeIcon}getLoaderIcon(){return this.options.loaderIcon}getVideoTemplate(t){let e,i,o,s,n,r,a,l,d,u,p=this.setTemplateLinkValues(t,"provider"),h=this.setTemplateLinkValues(t,"width",.7*window.innerWidth),m=this.setTemplateLinkValues(t,"height",.7*window.innerHeight),c=parseInt(this.setTemplateLinkValues(t,"autoplay")),v=this.setTemplateLinkValues(t,"rel"),g=parseInt(this.setTemplateLinkValues(t,"controls")),b=parseInt(this.setTemplateLinkValues(t,"showinfo")),k=this.setTemplateLinkValues(t,"theme","dark"),L=this.setTemplateLinkValues(t,"allowfullscreen"),A=this.setTemplateLinkValues(t,"title"),y=this.setTemplateLinkValues(t,"byline"),f=this.setTemplateLinkValues(t,"portrait"),w=this.setTemplateLinkValues(t,"loop"),C=parseInt(this.setTemplateLinkValues(t,"muted")),T=this.setTemplateLinkValues(t,"poster"),V=this.setTemplateLinkValues(t,"preload");switch(p){case"youtube":e=this.setTemplateLinkValues(t,"id","Q5fftru-t-g"),i=`//www.youtube-nocookie.com/embed/${e}?autoplay=${c}`,i+=`&loop=${w}`,i+=`&controls=${g}`,i+=`&rel=${v}`,i+=`&showinfo=${b}`,i+=`&theme=${"dark"===k||"light"===k?k:"dark"}`;break;case"youtubeplaylist":e=this.setTemplateLinkValues(t,"id","PLDz1o5Ur8b7V56es-ci2_HdykvZPLNU95"),i=`//www.youtube-nocookie.com/embed/videoseries?list=${e}&autoplay=${c}`,i+=`&loop=${w}`,i+=`&controls=${g}`,i+=`&rel=${v}`,i+=`&showinfo=${b}`;break;case"dailymotion":e=this.setTemplateLinkValues(t,"id","xta4r"),i=`//www.dailymotion.com/embed/video/${e}?info=${b}&autoPlay=${c}`;break;case"vimeo":e=this.setTemplateLinkValues(t,"id","210806913"),i=`//player.vimeo.com/video/${e}?autoplay=${c}`,i+=`&title=${A}`,i+=`&byline=${y}`,i+=`&portrait=${f}`,i+=`&loop=${w}`;break;default:i=this.setTemplateLinkValues(t,"id")}return this.hasNoProvider(t)?(s=document.createElement("video"),s.controls=g,s.loop=w,s.autoplay=c,s.muted=C,s.setAttribute("poster",T),s.setAttribute("preload",V),n=this.setTemplateLinkValues(t,"mp4"),r=this.setTemplateLinkValues(t,"ogg"),a=this.setTemplateLinkValues(t,"webm"),"null"!==n&&(l=document.createElement("source"),l.setAttribute("type","video/mp4"),l.setAttribute("src",n),s.appendChild(l)),"null"!==r&&(d=document.createElement("source"),d.setAttribute("type","video/ogg"),d.setAttribute("src",r),s.appendChild(d)),"null"!==a&&(u=document.createElement("source"),u.setAttribute("type","video/webm"),u.setAttribute("src",a),s.appendChild(u))):(this.isTarteAuCitronEnabled()&&this.isProviderAllowedByTarteAuCitron(p)?(s=document.createElement("div"),s.classList.add(`${"youtubeplaylist"===p?"youtube_playlist":p}_player`),s.setAttribute(""+("youtubeplaylist"===p?"playlistID":"videoID"),e),s.setAttribute("rel",v),s.setAttribute("controls",g),s.setAttribute("showinfo",b),s.setAttribute("autoplay",c),"vimeo"===p?(s.setAttribute("title",A),s.setAttribute("loop",w),s.setAttribute("byline",y),s.setAttribute("portrait",f)):"youtube"===p&&s.setAttribute("theme",k)):(s=document.createElement("iframe"),s.setAttribute("src",i),s.setAttribute("frameborder","0")),s.setAttribute("allowfullscreen",L)),!0===this.options.onlyLandscape&&window.matchMedia("(orientation: portrait)").matches?(s.setAttribute("width",m),s.setAttribute("height",h),o=parseInt((window.innerHeight-h)/2)):(s.setAttribute("width",h),s.setAttribute("height",m),o=parseInt((window.innerHeight-m)/2)),s.classList.add("videos_player"),s.style.marginTop=`${o}px`,s}createLink(t){let e=document.createElement("a");return this.editLink(e,t),e}editLink(t,e){return t.setAttribute("data-videos-modal-order",e.getAttribute("data-videos-modal-order")),t.setAttribute("data-videos-modal-id",this.getLinkAttribute(e,"id")),t.setAttribute("data-videos-modal-provider",this.getLinkAttribute(e,"provider")),t.setAttribute("data-videos-modal-width",this.getLinkAttribute(e,"width")),t.setAttribute("data-videos-modal-height",this.getLinkAttribute(e,"height")),t.setAttribute("data-videos-modal-autoplay",this.getLinkAttribute(e,"autoplay")),t.setAttribute("data-videos-modal-rel",this.getLinkAttribute(e,"rel")),t.setAttribute("data-videos-modal-controls",this.getLinkAttribute(e,"controls")),t.setAttribute("data-videos-modal-showinfo",this.getLinkAttribute(e,"showinfo")),t.setAttribute("data-videos-modal-allowfullscreen",this.getLinkAttribute(e,"allowfullscreen")),t.setAttribute("data-videos-modal-theme",this.getLinkAttribute(e,"theme")),t.setAttribute("data-videos-modal-title",this.getLinkAttribute(e,"title")),t.setAttribute("data-videos-modal-byline",this.getLinkAttribute(e,"byline")),t.setAttribute("data-videos-modal-portrait",this.getLinkAttribute(e,"portrait")),t.setAttribute("data-videos-modal-loop",this.getLinkAttribute(e,"loop")),t.setAttribute("data-videos-modal-muted",this.getLinkAttribute(e,"muted")),t.setAttribute("data-videos-modal-poster",this.getLinkAttribute(e,"poster")),t.setAttribute("data-videos-modal-preload",this.getLinkAttribute(e,"preload")),t.setAttribute("data-videos-modal-mp4",this.getLinkAttribute(e,"mp4")),t.setAttribute("data-videos-modal-ogg",this.getLinkAttribute(e,"ogg")),t.setAttribute("data-videos-modal-webm",this.getLinkAttribute(e,"webm")),this}setVideosModalContainer(){let t=this,e=t.getVideosModalContainer();null===e&&(e=document.createElement("div"),e.setAttribute("id","videos-modal")),!0===t.options.closeByIcon&&e.insertAdjacentHTML("beforeend",t.getCloseIcon()),!0===t.options.loading&&e.insertAdjacentHTML("beforeend",t.getLoaderIcon()),!0===t.options.onlyLandscape&&e.classList.add("only-landscape");let i=document.createElement("div");return i.setAttribute("id","videos-modal-background"),e.appendChild(i),document.body.appendChild(e),this}removeVideoContainer(){let t,e=this.getVideosModalContainer().getElementsByClassName("videos_player");for(t=e.length-1;t>=0;t--)e[t].parentNode.removeChild(e[t]);return this}isTarteAuCitronEnabled(){return null!==this.options.tarteAuCitron}isProviderAllowedByTarteAuCitron(t){let e=this.options.tarteAuCitron;return this.isTarteAuCitronEnabled()&&this.isProviderSupported(t)&&e.state[t]}setTemplateLinkValues(t,e,i=null){let o,s=t.getAttribute(`data-videos-modal-${e}`);return o=null!=s&&"null"!==s?s:null!==this.options[`videos_${e}`]?this.options[`videos_${e}`]:i,o}getLinkAttribute(t,e){return null!==t.getAttribute(`data-videos-modal-${e}`)?t.getAttribute(`data-videos-modal-${e}`):this.options[`videos_${e}`]}hasNoProvider(t){return"media"===this.setTemplateLinkValues(t,"provider")}onKeyDown(t){let e=this;if(e.getVideosModalContainer().classList.contains("opened"))switch(t.keyCode||t.which){case 27:!0===e.options.closeWithEscape&&e.close();break;case 37:!0===e.options.navigate&&e.linksNumber>1&&e.prev();break;case 39:!0===e.options.navigate&&e.linksNumber>1&&e.next()}}getVideosModalContainer(){return document.getElementById("videos-modal")}getNavigationPrevLink(){return document.getElementById("videos-modal-prev-link")}getNavigationNextLink(){return document.getElementById("videos-modal-next-link")}getDefaultLoaderIcon(){return'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="videos-modal-loader">\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(0 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.875s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(45 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.75s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(90 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.625s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(135 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.5s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(180 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.375s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(225 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.25s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(270 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="-0.125s" repeatCount="indefinite"/>\n    </rect>\n    <rect x="47" y="22.5" rx="9.4" ry="4.5" width="6" height="15" fill="#fff" transform="rotate(315 50 50)">\n        <animate attributeName="opacity" values="1;0" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"/>\n    </rect>\n</svg>'}getDefaultCloseIcon(){return'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" id="videos-modal-close" viewBox="0 0 32 32"\n    style="enable-background:new 0 0 32 32;" xml:space="preserve">\n    <path fill="#999" d="M30.3448276,31.4576271 C29.9059965,31.4572473 29.4852797,31.2855701 29.1751724,30.980339\n        L0.485517241,2.77694915 C-0.122171278,2.13584324 -0.104240278,1.13679247 0.52607603,0.517159487 C1.15639234,\n        -0.102473494 2.17266813,-0.120100579 2.82482759,0.477288136 L31.5144828,28.680678 C31.9872448,29.1460053\n        32.1285698,29.8453523 31.8726333,30.4529866 C31.6166968,31.0606209 31.0138299,31.4570487 30.3448276,31.4576271 Z" />\n    <path fill="#999" d="M1.65517241,31.4576271 C0.986170142,31.4570487 0.383303157,31.0606209 0.127366673,30.4529866\n        C-0.12856981,29.8453523 0.0127551942,29.1460053 0.485517241,28.680678 L29.1751724,0.477288136 C29.8273319,\n        -0.120100579 30.8436077,-0.102473494 31.473924,0.517159487 C32.1042403,1.13679247 32.1221713,2.13584324\n        31.5144828,2.77694915 L2.82482759,30.980339 C2.51472031,31.2855701 2.09400353,31.4572473 1.65517241,31.4576271 Z" />\n</svg>'}getDefaultLeftArrow(){return'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="videos-modal-left-arrow"\n    viewBox="0 0 11.4 20" style="enable-background:new 0 0 11.4 20;" xml:space="preserve">\n    <path fill="#999" d="M0.4,9L9,0.4c0.5-0.5,1.4-0.5,2,0c0.5,0.5,0.5,1.4,0,2L3.4,10l7.6,7.6c0.5,0.5,0.5,1.4,0,2\n        c-0.5,0.5-1.4,0.5-2,0L0.4,11C-0.2,10.4-0.2,9.6,0.4,9L0.4,9L0.4,9z"/>\n</svg>'}getDefaultRightArrow(){return'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="videos-modal-right-arrow"\n    viewBox="0 0 11.4 20" style="enable-background:new 0 0 11.4 20;" xml:space="preserve">\n    <path fill="#999" d="M11,11l-8.6,8.6c-0.5,0.5-1.4,0.5-2,0c-0.5-0.5-0.5-1.4,0-2L8,10L0.4,2.4c-0.5-0.5-0.5-1.4,0-2\n    c0.5-0.5,1.4-0.5,2,0L11,9C11.5,9.6,11.5,10.4,11,11C11,11,11,11,11,11L11,11z"/>\n</svg>'}}